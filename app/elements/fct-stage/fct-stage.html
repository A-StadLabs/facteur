<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/geo-location/geo-location.html">
<link rel="import" href="../../bower_components/google-map/google-map.html">
<link rel="import" href="../../bower_components/google-signin/google-signin.html">
<link rel="import" href="../../bower_components/core-icon-button/core-icon-button.html">
<link rel="import" href="../../bower_components/firebase-element/firebase-element.html">

<!-- Our components -->
<link rel="import" href="../../elements/fct-letterhead/fct-letterhead.html">

<polymer-element name="fct-stage" attributes="">
  <template>
    <link rel="stylesheet" href="fct-stage.css">

    <google-signin width="iconOnly" clientId="759839009338-n80siiikg3977u0qn277ebctn5s3pbgt.apps.googleusercontent.com" scopes="profile" id="gsign"></google-signin>

    <firebase-element id="base" on-data-change="{{handleResponse}}" keys="{{keys}}" data="{{data}}" location="https://facteur.firebaseio.com/posts/"></firebase-element>

    <geo-location watchpos highAccuracy id="geolocation" longitude="{{longitude}}" latitude="{{latitude}}"></geo-location>

    <google-map map="{{map}}" zoom="17"  latitude="{{latitude}}" disableDefaultUI draggable="false" longitude="{{longitude}}" id="googlemap">
      <template repeat="{{ key in keys }}">
        <google-map-marker latitude="{{data[key].latitude}}" longitude="{{data[key].longitude}}"></google-map-marker>
      </template>
    </google-map> 

  </template>
  <script>
    (function () {
      'use strict';

      document.addEventListener("google-signin-success", function(e) {
        // Access the GAPI instance passed back from authorization
        var gapi = e.detail.gapi;

        // Load V1 of the G+ API
        gapi.client.load('plus', 'v1', function() {
            // To retreive profile information for a user, use the
            // people.get API method. For profile info for the currently
            // authorized user, use the userId value of me.
            var request = gapi.client.plus.people.get({
                'userId': 'me'
            });

            request.execute(function(resp) {
                // Some useful profile information is now available
                // via the returned object (resp). For example, we
                // can discover the displayName, skills and so on.
                console.log(resp);

                // // This data can then be rendered into a template:
                // var t = document.querySelector("#profile");
                // t.model = {};
                // t.model.profile = resp;
            });
        });
        // document.querySelector("#status").innerHTML = "You are now signed in.";
        console.log('you are now signed in.');
    });

      Polymer({
        // define element prototype here
      });

    })();
  </script>
</polymer-element>
